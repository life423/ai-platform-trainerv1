<!-- Generated by SpecStory -->

# Training enemy agent with GPU commands (2025-05-28 01:43:04)

_**User**_

@workspace what are the terminal commands I need to run to train my enemy agent with my gpu?

---

_**Assistant**_

Based on your workspace, you have several options for training your enemy agent with GPU acceleration. Here are the main approaches:

## Option 1: Pure NumPy GPU Training (Recommended)

This uses your custom CUDA kernels without PyTorch:

```bash
python -m ai_platform_trainer.ai.models.train_enemy_rl_gpu
```

## Option 2: GPU Environment with Stable-Baselines3

Train using your CUDA physics engine with PPO:

```bash
python ai_platform_trainer/cpp/train_gpu_fixed.py --num-envs 4 --timesteps 100000
```

## Option 3: Build and Test Pipeline

Run the complete GPU pipeline build and test:

```bash
python build_and_test_gpu_pipeline.py
```

## Option 4: Multi-method Training Script

This auto-detects the best available method (CUDA, PyTorch, or CPU):

```bash
python train_enemy_agent.py --episodes 500 --output models/enemy_rl/gpu_model
```

## Verification First

Before training, verify your GPU setup works:

```bash
# Test GPU environment
python test_gpu_success.py

# Verify CUDA kernels
python ai_platform_trainer/cpp/verify_gpu_training.py --cuda-test

# Quick pipeline test
python test_gpu_rl_pipeline.py
```

## Recommended Workflow

1. **Verify GPU setup**:
   ```bash
   python test_gpu_success.py
   ```

2. **Train with pure NumPy (no PyTorch dependency)**:
   ```bash
   python -m ai_platform_trainer.ai.models.train_enemy_rl_gpu
   ```

This will use your custom CUDA kernels from `physics.cu` for GPU-accelerated physics simulation and train the enemy agent using Evolution Strategy optimization.

The trained model will be saved to `enemy_rl_gpu.npz`.

---

